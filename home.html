<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />

		<!-- ✅ SEO Meta Tags -->
		<title>Testing | Home Page</title>
		<meta name="description" content="A testing homepage that displays user information after Google login authentication." />
		<meta name="author" content="Testing" />
		<meta name="keywords" content="Google Login, OAuth, JWT, JavaScript, Testing Project, Web App" />
		<meta name="robots" content="index, follow" />
		<meta property="og:title" content="Testing | Home Page" />
		<meta property="og:description" content="A testing homepage that displays user information after Google login authentication." />
		<meta property="og:type" content="website" />
		<meta property="og:url" content="https://yourdomain.com/home.html" />
		<meta property="og:image" content="https://yourdomain.com/preview-image.jpg" />

		<!-- ✅ Favicon (optional, replace with your own if available) -->
		<link rel="icon" href="https://yourdomain.com/favicon.ico" />

		<!-- ✅ Your CSS styles -->
		<style>
			body {
				font-family: Arial, sans-serif;
				display: flex;
				flex-direction: column;
				justify-content: center;
				align-items: center;
				min-height: 100vh;
				background-color: #f0f2f5;
				margin: 0;
				padding: 20px;
			}
			.home-container {
				background-color: #fff;
				padding: 40px;
				border-radius: 8px;
				box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
				text-align: center;
				max-width: 600px;
				width: 100%;
			}
			h1 {
				color: #333;
				margin-bottom: 20px;
			}
			pre {
				background-color: #e9e9e9;
				padding: 15px;
				border-radius: 5px;
				text-align: left;
				white-space: pre-wrap;
				word-break: break-all;
				margin-top: 20px;
			}
			.user-info img {
				border-radius: 50%;
				width: 80px;
				height: 80px;
				margin-bottom: 15px;
			}
			.user-info p {
				margin: 5px 0;
				color: #555;
			}
			.logout-button {
				margin-top: 30px;
				padding: 10px 20px;
				background-color: #dc3545;
				color: white;
				border: none;
				border-radius: 5px;
				cursor: pointer;
				font-size: 16px;
			}
			.logout-button:hover {
				background-color: #c82333;
			}
		</style>
	</head>
	<body>
		<div class="home-container">
			<h1>Welcome, <span id="userName">Guest</span>!</h1>
			<div class="user-info">
				<img
					id="userPicture"
					src=""
					alt="User Profile Picture"
					style="display: none"
				/>
				<p>Email: <span id="userEmail"></span></p>
				<p>ID: <span id="userId"></span></p>
			</div>
			<h2>Full ID Token (Decoded):</h2>
			<pre id="responseOutput"></pre>
			<button class="logout-button" onclick="logout()">Logout</button>
		</div>

		<script src="https://cdnjs.cloudflare.com/ajax/libs/jwt-decode/3.1.2/jwt-decode.min.js"></script>
		<script>
			function parseJwt(token) {
				const base64Url = token.split(".")[1];
				const base64 = base64Url.replace(/-/g, "+").replace(/_/g, "/");
				const jsonPayload = decodeURIComponent(
					atob(base64)
						.split("")
						.map(function (c) {
							return "%" + ("00" + c.charCodeAt(0).toString(16)).slice(-2);
						})
						.join("")
				);
				return JSON.parse(jsonPayload);
			}

			function displayUserInfo() {
				const token = sessionStorage.getItem("google_id_token");

				if (token) {
					try {
						const decodedToken = parseJwt(token);
						console.log("Decoded Token:", decodedToken);

						document.getElementById("userName").textContent =
							decodedToken.name || "User";
						document.getElementById("userEmail").textContent =
							decodedToken.email || "N/A";
						document.getElementById("userId").textContent =
							decodedToken.sub || "N/A";

						const userPicture = document.getElementById("userPicture");
						if (decodedToken.picture) {
							userPicture.src = decodedToken.picture;
							userPicture.style.display = "block";
						} else {
							userPicture.style.display = "none";
						}

						document.getElementById("responseOutput").textContent =
							JSON.stringify(decodedToken, null, 2);
					} catch (error) {
						console.error("Error decoding JWT token:", error);
						document.getElementById("responseOutput").textContent =
							"Error decoding token or token invalid.";
					}
				} else {
					console.log("No Google ID token found. Redirecting to login.");
					window.location.href = "index.html";
				}
			}

			function logout() {
				sessionStorage.removeItem("google_id_token");
				window.location.href = "index.html";
			}

			document.addEventListener("DOMContentLoaded", displayUserInfo);
		</script>
	</body>
</html>
